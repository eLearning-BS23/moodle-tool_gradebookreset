{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","ModalFactory","ModalEvents","Notification","on","e","elementid","attr","array","split","userid","length","courseid","clickedLink","currentTarget","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","root","getRoot","save","request","methodname","args","console","log","call","done","data","warnings","addNotification","message","window","location","href","fail","exception","show"],"mappings":"AAUAA,OAAM,0CAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,oBAAxB,CAA8C,mBAA9C,CAAmE,mBAAnE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAA6CC,CAA7C,CAA2D,CACvDJ,CAAC,CAAC,cAAD,CAAD,CAAkBK,EAAlB,CAAqB,OAArB,CAA8B,SAASC,CAAT,CAAY,IAClCC,CAAAA,CAAS,CAAGP,CAAC,CAAC,IAAD,CAAD,CAAQQ,IAAR,CAAa,IAAb,CADsB,CAElCC,CAAK,CAAGF,CAAS,CAACG,KAAV,CAAgB,GAAhB,CAF0B,CAGlCC,CAAM,CAAGF,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAHoB,CAIlCC,CAAQ,CAAGJ,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAJkB,CAKlCE,CAAW,CAAGd,CAAC,CAACM,CAAC,CAACS,aAAH,CALmB,CAMtCb,CAAY,CAACc,MAAb,CAAoB,CAChBC,IAAI,CAAEf,CAAY,CAACgB,KAAb,CAAmBC,WADT,CAEhBC,KAAK,CAAE,aAFS,CAGhBC,IAAI,CAAE,8BAHU,CAApB,EAIGC,IAJH,CAIQ,SAAUC,CAAV,CAAiB,CACrBA,CAAK,CAACC,iBAAN,CAAwB,OAAxB,EACA,GAAIC,CAAAA,CAAI,CAAGF,CAAK,CAACG,OAAN,EAAX,CACAD,CAAI,CAACpB,EAAL,CAAQF,CAAW,CAACwB,IAApB,CAA0B,UAAY,IAO9BC,CAAAA,CAAO,CAAG,CACVC,UAAU,0CADA,CAEVC,IAAI,CANK,CACT,OAAUnB,CADD,CAET,SAAYE,CAFH,CAIC,CAPoB,CAWlCkB,OAAO,CAACC,GAAR,CAAYJ,CAAZ,EACA3B,CAAI,CAACgC,IAAL,CAAU,CAACL,CAAD,CAAV,EAAqB,CAArB,EAAwBM,IAAxB,CAA6B,SAASC,CAAT,CAAe,CAExC,GAA2B,CAAvB,CAAAA,CAAI,CAACC,QAAL,CAAcxB,MAAlB,CAA8B,CAE1BmB,OAAO,CAACC,GAAR,CAAY,UAAZ,EACAD,OAAO,CAACC,GAAR,CAAYG,CAAZ,EACA/B,CAAY,CAACiC,eAAb,CAA6B,CACzBC,OAAO,CAAE,OADgB,CAEzBrB,IAAI,CAAE,SAFmB,CAA7B,EAIAsB,MAAM,CAACC,QAAP,CAAgBC,IAAhB,0EAAyF5B,CAAzF,6BACH,CATD,IASO,CACHT,CAAY,CAACiC,eAAb,CAA6B,CACzBC,OAAO,CAAE,uBADgB,CAEzBrB,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CAjBD,EAiBGyB,IAjBH,CAiBQtC,CAAY,CAACuC,SAjBrB,CAkBH,CA9BD,EA+BApB,CAAK,CAACqB,IAAN,EACP,CAvCG,CAwCP,CA9CG,CA+CP,CAjDK,CAAN","sourcesContent":["// define(['jquery','core/notification'], function($) {\n//     $(document).ready(function ($,notification) {\n//         //console.log(\"Hello world! from lib file\");\n//         $('.resetbutton').click(function () {\n//             console.log($(this).attr('id'));\n//             confirm(\"are you sure?\");\n//         });\n//     });\n//\n// });\ndefine(['jquery', 'core/ajax', 'core/modal_factory', 'core/modal_events', 'core/notification'],\n    function($, Ajax, ModalFactory, ModalEvents, Notification) {\n        $('.resetbutton').on('click', function(e) {\n            var elementid = $(this).attr('id');\n            var array = elementid.split(\"_\");\n            var userid = array[array.length - 2];\n            var courseid = array[array.length - 1];\n            var clickedLink = $(e.currentTarget);\n            ModalFactory.create({\n                type: ModalFactory.types.SAVE_CANCEL,\n                title: 'Reset grade',\n                body: 'Do you really want to reset?',\n            }).then(function (modal) {\n                modal.setSaveButtonText('Reset');\n                var root = modal.getRoot();\n                root.on(ModalEvents.save, function () {\n                    //var elementid = clickedLink.data('id');\n                    var wsfunction = 'tool_resetcoursecompletion_reset_grades';\n                    var params = {\n                        'userid': userid,\n                        'courseid': courseid,\n                    };\n                    var request = {\n                        methodname: wsfunction,\n                        args: params\n                    };\n                    console.log(request);\n                    Ajax.call([request])[0].done(function(data) {\n\n                        if (data.warnings.length < 1) {\n\n                            console.log(\"Response\");\n                            console.log(data);\n                            Notification.addNotification({\n                                message: 'Done!',\n                                type: 'success'\n                            });\n                            window.location.href = `http://localhost/admin/tool/resetcoursecompletion/index.php?id=${courseid}&submit=Show+Participants`;\n                        } else {\n                            Notification.addNotification({\n                                message: 'Something went wrong!',\n                                type: 'error'\n                            });\n                        }\n                    }).fail(Notification.exception);\n                });\n                modal.show();\n        });\n    });\n});"],"file":"resetbutton.min.js"}