{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","ModalFactory","ModalEvents","Notification","on","e","elementid","attr","array","split","userid","length","courseid","clickedLink","currentTarget","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","root","getRoot","save","request","methodname","args","console","log","call","done","data","warnings","window","location","href","addNotification","message","fail","exception","show"],"mappings":"AAUAA,OAAM,0CAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,oBAAxB,CAA8C,mBAA9C,CAAmE,mBAAnE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAA6CC,CAA7C,CAA2D,CACvDJ,CAAC,CAAC,cAAD,CAAD,CAAkBK,EAAlB,CAAqB,OAArB,CAA8B,SAASC,CAAT,CAAY,IAClCC,CAAAA,CAAS,CAAGP,CAAC,CAAC,IAAD,CAAD,CAAQQ,IAAR,CAAa,IAAb,CADsB,CAElCC,CAAK,CAAGF,CAAS,CAACG,KAAV,CAAgB,GAAhB,CAF0B,CAGlCC,CAAM,CAAGF,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAHoB,CAIlCC,CAAQ,CAAGJ,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAJkB,CAKlCE,CAAW,CAAGd,CAAC,CAACM,CAAC,CAACS,aAAH,CALmB,CAMtCb,CAAY,CAACc,MAAb,CAAoB,CAChBC,IAAI,CAAEf,CAAY,CAACgB,KAAb,CAAmBC,WADT,CAEhBC,KAAK,CAAE,aAFS,CAGhBC,IAAI,CAAE,8BAHU,CAApB,EAIGC,IAJH,CAIQ,SAAUC,CAAV,CAAiB,CACrBA,CAAK,CAACC,iBAAN,CAAwB,OAAxB,EACA,GAAIC,CAAAA,CAAI,CAAGF,CAAK,CAACG,OAAN,EAAX,CACAD,CAAI,CAACpB,EAAL,CAAQF,CAAW,CAACwB,IAApB,CAA0B,UAAY,IAO9BC,CAAAA,CAAO,CAAG,CACVC,UAAU,0CADA,CAEVC,IAAI,CANK,CACT,OAAUnB,CADD,CAET,SAAYE,CAFH,CAIC,CAPoB,CAWlCkB,OAAO,CAACC,GAAR,CAAYJ,CAAZ,EACA3B,CAAI,CAACgC,IAAL,CAAU,CAACL,CAAD,CAAV,EAAqB,CAArB,EAAwBM,IAAxB,CAA6B,SAASC,CAAT,CAAe,CAExC,GAA2B,CAAvB,CAAAA,CAAI,CAACC,QAAL,CAAcxB,MAAlB,CAA8B,CAE1BmB,OAAO,CAACC,GAAR,CAAY,UAAZ,EACAD,OAAO,CAACC,GAAR,CAAYG,CAAZ,EAKAE,MAAM,CAACC,QAAP,CAAgBC,IAAhB,iFAAgG1B,CAAhG,6BACH,CATD,IASO,CACHT,CAAY,CAACoC,eAAb,CAA6B,CACzBC,OAAO,CAAE,uBADgB,CAEzBxB,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CAjBD,EAiBGyB,IAjBH,CAiBQtC,CAAY,CAACuC,SAjBrB,CAkBH,CA9BD,EA+BApB,CAAK,CAACqB,IAAN,EACP,CAvCG,CAwCP,CA9CG,CA+CP,CAjDK,CAAN","sourcesContent":["// define(['jquery','core/notification'], function($) {\r\n//     $(document).ready(function ($,notification) {\r\n//         //console.log(\"Hello world! from lib file\");\r\n//         $('.resetbutton').click(function () {\r\n//             console.log($(this).attr('id'));\r\n//             confirm(\"are you sure?\");\r\n//         });\r\n//     });\r\n//\r\n// });\r\ndefine(['jquery', 'core/ajax', 'core/modal_factory', 'core/modal_events', 'core/notification'],\r\n    function($, Ajax, ModalFactory, ModalEvents, Notification) {\r\n        $('.resetbutton').on('click', function(e) {\r\n            var elementid = $(this).attr('id');\r\n            var array = elementid.split(\"_\");\r\n            var userid = array[array.length - 2];\r\n            var courseid = array[array.length - 1];\r\n            var clickedLink = $(e.currentTarget);\r\n            ModalFactory.create({\r\n                type: ModalFactory.types.SAVE_CANCEL,\r\n                title: 'Reset grade',\r\n                body: 'Do you really want to reset?',\r\n            }).then(function (modal) {\r\n                modal.setSaveButtonText('Reset');\r\n                var root = modal.getRoot();\r\n                root.on(ModalEvents.save, function () {\r\n                    //var elementid = clickedLink.data('id');\r\n                    var wsfunction = 'tool_resetcoursecompletion_reset_grades';\r\n                    var params = {\r\n                        'userid': userid,\r\n                        'courseid': courseid,\r\n                    };\r\n                    var request = {\r\n                        methodname: wsfunction,\r\n                        args: params\r\n                    };\r\n                    console.log(request);\r\n                    Ajax.call([request])[0].done(function(data) {\r\n\r\n                        if (data.warnings.length < 1) {\r\n\r\n                            console.log(\"Response\");\r\n                            console.log(data);\r\n                            // Notification.addNotification({\r\n                            //     message: 'Done!',\r\n                            //     type: 'success'\r\n                            // });\r\n                            window.location.href = `http://localhost/moodle/admin/tool/resetcoursecompletion/index.php?id=${courseid}&submit=Show+Participants`;\r\n                        } else {\r\n                            Notification.addNotification({\r\n                                message: 'Something went wrong!',\r\n                                type: 'error'\r\n                            });\r\n                        }\r\n                    }).fail(Notification.exception);\r\n                });\r\n                modal.show();\r\n        });\r\n    });\r\n});"],"file":"resetbutton.min.js"}