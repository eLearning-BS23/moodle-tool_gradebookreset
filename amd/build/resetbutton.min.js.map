{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","str","ModalFactory","ModalEvents","Notification","on","e","myArray","elementid","attr","console","log","each","k","V","checked","push","value","array","split","courseid","length","clickedLink","currentTarget","alert","create","type","types","SAVE_CANCEL","title","get_string","body","then","modal","setSaveButtonText","root","getRoot","save","params","join","request","methodname","args","call","done","data","warnings","window","location","href","addNotification","message","fail","exception","show"],"mappings":"AAsBAA,OAAM,0CAAC,CACH,QADG,CAEH,WAFG,CAGH,UAHG,CAIH,oBAJG,CAKH,mBALG,CAMH,mBANG,CAAD,CAOH,SAAUC,CAAV,CACUC,CADV,CAEUC,CAFV,CAGUC,CAHV,CAIUC,CAJV,CAKUC,CALV,CAKwB,CAEvBL,CAAC,CAAC,cAAD,CAAD,CAAkBM,EAAlB,CAAqB,OAArB,CAA8B,SAAUC,CAAV,CAAa,IACnCC,CAAAA,CAAO,CAAG,EADyB,CAEnCC,CAAS,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQU,IAAR,CAAa,IAAb,CAFuB,CAIvCC,OAAO,CAACC,GAAR,CAAYH,CAAZ,EAEAT,CAAC,CAAC,aAAD,CAAD,CAAiBa,IAAjB,CAAsB,SAAUC,CAAV,CAAaC,CAAb,CAAgB,CAClC,GAAIA,CAAC,CAACC,OAAN,CAAe,CACXR,CAAO,CAACS,IAAR,CAAaF,CAAC,CAACG,KAAf,EACAP,OAAO,CAACC,GAAR,CAAYJ,CAAZ,CACH,CACJ,CALD,EANuC,GAanCW,CAAAA,CAAK,CAAGV,CAAS,CAACW,KAAV,CAAgB,GAAhB,CAb2B,CAcnCC,CAAQ,CAAGF,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAdmB,CAiBnCC,CAAW,CAAGvB,CAAC,CAACO,CAAC,CAACiB,aAAH,CAjBoB,CAmBvCb,OAAO,CAACC,GAAR,CAAYJ,CAAZ,EACA,GAAmB,CAAhB,EAAAA,CAAO,CAACc,MAAX,CACA,CACGG,KAAK,CAAC,qBAAD,CACP,CAHD,IAKK,CACGtB,CAAY,CAACuB,MAAb,CAAoB,CAChBC,IAAI,CAAExB,CAAY,CAACyB,KAAb,CAAmBC,WADT,CAEhBC,KAAK,CAAE5B,CAAG,CAAC6B,UAAJ,CAAe,YAAf,CAA4B,4BAA5B,CAFS,CAGhBC,IAAI,CAAE9B,CAAG,CAAC6B,UAAJ,CAAe,iBAAf,CAAiC,4BAAjC,CAHU,CAApB,EAIGE,IAJH,CAIQ,SAAUC,CAAV,CAAiB,CACrBA,CAAK,CAACC,iBAAN,CAAwB,OAAxB,EACA,GAAIC,CAAAA,CAAI,CAAGF,CAAK,CAACG,OAAN,EAAX,CACAD,CAAI,CAAC9B,EAAL,CAAQF,CAAW,CAACkC,IAApB,CAA0B,UAAY,IAE9BC,CAAAA,CAAM,CAAG,CACT,YAAe/B,CAAO,CAACgC,IAAR,CAAa,GAAb,CADN,CAET,SAAYnB,CAFH,CAFqB,CAM9BoB,CAAO,CAAG,CACVC,UAAU,0CADA,CAEVC,IAAI,CAAEJ,CAFI,CANoB,CAUlC5B,OAAO,CAACC,GAAR,CAAY6B,CAAZ,EACAxC,CAAI,CAAC2C,IAAL,CAAU,CAACH,CAAD,CAAV,EAAqB,CAArB,EAAwBI,IAAxB,CAA6B,SAAUC,CAAV,CAAgB,CAEzC,GAA2B,CAAvB,CAAAA,CAAI,CAACC,QAAL,CAAczB,MAAlB,CAA8B,CAE1BX,OAAO,CAACC,GAAR,CAAY,UAAZ,EACAD,OAAO,CAACC,GAAR,CAAYkC,CAAZ,EAEAE,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuBlD,CAAC,CAACiD,QAAD,CAAD,CAAYvC,IAAZ,CAAiB,MAAjB,CAG1B,CARD,IAQO,CACHL,CAAY,CAAC8C,eAAb,CAA6B,CACzBC,OAAO,CAAE,uBADgB,CAEzBzB,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CAhBD,EAgBG0B,IAhBH,CAgBQhD,CAAY,CAACiD,SAhBrB,CAiBH,CA5BD,EA6BApB,CAAK,CAACqB,IAAN,EACH,CArCD,CAsCP,CAEJ,CAlED,CAoEH,CAlFK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  The Reset Course Completion grade report\n *\n * @module     tool_resetcoursecompletion\n * @copyright  2021 Brain station 23 ltd <>  {@link https://brainstation-23.com/}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/notification'\n], function ($,\n             Ajax,\n             str,\n             ModalFactory,\n             ModalEvents,\n             Notification) {\n\n    $('.resetbutton').on('click', function (e) {\n        var myArray = [];\n        var elementid = $(this).attr('id');\n\n        console.log(elementid);\n\n        $('.myCheckbox').each(function (k, V) {\n            if (V.checked) {\n                myArray.push(V.value);\n                console.log(myArray);\n            }\n        })\n\n        var array = elementid.split(\"_\");\n        var courseid = array[array.length - 1];\n\n\n        var clickedLink = $(e.currentTarget);\n\n        console.log(myArray);\n        if(myArray.length<=0)\n        {\n           alert(\"Select a user first\");\n        }\n\n        else {\n                ModalFactory.create({\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    title: str.get_string('resettitle','tool_resetcoursecompletion'),\n                    body: str.get_string('resetpermission','tool_resetcoursecompletion')\n                }).then(function (modal) {\n                    modal.setSaveButtonText('Reset');\n                    var root = modal.getRoot();\n                    root.on(ModalEvents.save, function () {\n                        var wsfunction = 'tool_resetcoursecompletion_reset_grades';\n                        var params = {\n                            'useridArray': myArray.join(','),\n                            'courseid': courseid,\n                        };\n                        var request = {\n                            methodname: wsfunction,\n                            args: params\n                        };\n                        console.log(request);\n                        Ajax.call([request])[0].done(function (data) {\n\n                            if (data.warnings.length < 1) {\n\n                                console.log(\"Response\");\n                                console.log(data);\n                                // window.location.href = `http://localhost/moodle/admin/tool/resetcoursecompletion/index.php?id=${courseid}&submit=Show+Participants`;\n                                window.location.href = $(location).attr('href');\n\n\n                            } else {\n                                Notification.addNotification({\n                                    message: 'Something went wrong!',\n                                    type: 'error'\n                                });\n                            }\n                        }).fail(Notification.exception);\n                    });\n                    modal.show();\n                });\n        }\n\n    });\n\n});"],"file":"resetbutton.min.js"}