{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","str","ModalFactory","ModalEvents","Notification","on","e","myArray","elementid","attr","console","log","each","k","V","checked","push","value","array","split","courseid","length","clickedLink","currentTarget","get_string","then","langString","addNotification","message","type","catch","exception","create","types","SAVE_CANCEL","title","body","modal","setSaveButtonText","root","getRoot","save","params","join","request","methodname","args","call","done","data","warnings","window","location","href","fail","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n *  The Reset Course Completion grade report\n *\n * @module     tool_resetcoursecompletion\n * @copyright  2021 Brain station 23 ltd <>  {@link https://brainstation-23.com/}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/str',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/notification'\n], function ($,\n             Ajax,\n             str,\n             ModalFactory,\n             ModalEvents,\n             Notification) {\n\n    $('.resetbutton').on('click', function (e) {\n        var myArray = [];\n        var elementid = $(this).attr('id');\n\n        console.log(elementid);\n\n        $('.myCheckbox').each(function (k, V) {\n            if (V.checked) {\n                myArray.push(V.value);\n                console.log(myArray);\n            }\n        })\n\n        var array = elementid.split(\"_\");\n        var courseid = array[array.length - 1];\n\n\n        var clickedLink = $(e.currentTarget);\n\n        console.log(myArray);\n        if(myArray.length<=0)\n        {\n           // let string_alert = str.get_string('selectalert','tool_resetcoursecompletion');\n           // alert(string_alert);\n\n           // alert(str.get_string('selectalert','tool_resetcoursecompletion'));\n\n            str.get_string('selectalert', 'tool_resetcoursecompletion').then(function(langString) {\n                Notification.addNotification({\n                    message: langString,\n                    type: 'error'\n                });\n\n            }).catch(Notification.exception);\n        }\n\n        else {\n                ModalFactory.create({\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    title: str.get_string('resettitle','tool_resetcoursecompletion'),\n                    body: str.get_string('resetpermission','tool_resetcoursecompletion')\n                }).then(function (modal) {\n                    modal.setSaveButtonText(str.get_string('reset','tool_resetcoursecompletion'));\n                    var root = modal.getRoot();\n                    root.on(ModalEvents.save, function () {\n                        var wsfunction = 'tool_resetcoursecompletion_reset_grades';\n                        var params = {\n                            'useridArray': myArray.join(','),\n                            'courseid': courseid,\n                        };\n                        var request = {\n                            methodname: wsfunction,\n                            args: params\n                        };\n                        console.log(request);\n                        Ajax.call([request])[0].done(function (data) {\n\n                            if (data.warnings.length < 1) {\n\n                                console.log(\"Response\");\n                                console.log(data);\n                                // window.location.href = `http://localhost/moodle/admin/tool/resetcoursecompletion/index.php?id=${courseid}&submit=Show+Participants`;\n                                window.location.href = $(location).attr('href');\n\n\n                            } else {\n                                Notification.addNotification({\n                                    message: 'Something went wrong!',\n                                    type: 'error'\n                                });\n                            }\n                        }).fail(Notification.exception);\n                    });\n                    modal.show();\n                });\n        }\n\n    });\n\n});"],"file":"resetbutton.min.js"}