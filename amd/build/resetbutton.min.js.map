{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","ModalFactory","ModalEvents","Notification","on","e","myArray","elementid","attr","each","k","V","checked","push","value","array","split","courseid","length","clickedLink","currentTarget","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","root","getRoot","save","request","methodname","args","console","log","call","done","data","warnings","window","location","href","addNotification","message","fail","exception","show"],"mappings":"AAWAA,OAAM,0CAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,oBAAxB,CAA8C,mBAA9C,CAAmE,mBAAnE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAA6CC,CAA7C,CAA2D,CACvDJ,CAAC,CAAC,cAAD,CAAD,CAAkBK,EAAlB,CAAqB,OAArB,CAA8B,SAASC,CAAT,CAAY,IAElCC,CAAAA,CAAO,CAAG,EAFwB,CAGlCC,CAAS,CAAGR,CAAC,CAAC,IAAD,CAAD,CAAQS,IAAR,CAAa,IAAb,CAHsB,CAStCT,CAAC,CAAC,aAAD,CAAD,CAAiBU,IAAjB,CAAsB,SAASC,CAAT,CAAWC,CAAX,CAAa,CAC/B,GAAGA,CAAC,CAACC,OAAL,CACA,CAIKN,CAAO,CAACO,IAAR,CAAaF,CAAC,CAACG,KAAf,CAEJ,CACJ,CATD,EATsC,GAoBlCC,CAAAA,CAAK,CAAGR,CAAS,CAACS,KAAV,CAAgB,GAAhB,CApB0B,CAsBlCC,CAAQ,CAAGF,CAAK,CAACA,CAAK,CAACG,MAAN,CAAe,CAAhB,CAtBkB,CAyBlCC,CAAW,CAAGpB,CAAC,CAACM,CAAC,CAACe,aAAH,CAzBmB,CA0BtCnB,CAAY,CAACoB,MAAb,CAAoB,CAChBC,IAAI,CAAErB,CAAY,CAACsB,KAAb,CAAmBC,WADT,CAEhBC,KAAK,CAAE,aAFS,CAGhBC,IAAI,CAAE,8BAHU,CAApB,EAIGC,IAJH,CAIQ,SAAUC,CAAV,CAAiB,CACrBA,CAAK,CAACC,iBAAN,CAAwB,OAAxB,EACA,GAAIC,CAAAA,CAAI,CAAGF,CAAK,CAACG,OAAN,EAAX,CACAD,CAAI,CAAC1B,EAAL,CAAQF,CAAW,CAAC8B,IAApB,CAA0B,UAAY,IAQ9BC,CAAAA,CAAO,CAAG,CACVC,UAAU,0CADA,CAEVC,IAAI,CAPK,CAET,YAAe7B,CAFN,CAGT,SAAYW,CAHH,CAKC,CARoB,CAYlCmB,OAAO,CAACC,GAAR,CAAYJ,CAAZ,EACAjC,CAAI,CAACsC,IAAL,CAAU,CAACL,CAAD,CAAV,EAAqB,CAArB,EAAwBM,IAAxB,CAA6B,SAASC,CAAT,CAAe,CAExC,GAA2B,CAAvB,CAAAA,CAAI,CAACC,QAAL,CAAcvB,MAAlB,CAA8B,CAE1BkB,OAAO,CAACC,GAAR,CAAY,UAAZ,EACAD,OAAO,CAACC,GAAR,CAAYG,CAAZ,EAKAE,MAAM,CAACC,QAAP,CAAgBC,IAAhB,iFAAgG3B,CAAhG,6BAEH,CAVD,IAUO,CACHd,CAAY,CAAC0C,eAAb,CAA6B,CACzBC,OAAO,CAAE,uBADgB,CAEzBxB,IAAI,CAAE,OAFmB,CAA7B,CAIH,CACJ,CAlBD,EAkBGyB,IAlBH,CAkBQ5C,CAAY,CAAC6C,SAlBrB,CAmBH,CAhCD,EAiCApB,CAAK,CAACqB,IAAN,EACP,CAzCG,CA0CP,CApEG,CAsEP,CAxEK,CAAN","sourcesContent":["// define(['jquery','core/notification'], function($) {\r\n//     $(document).ready(function ($,notification) {\r\n//         //console.log(\"Hello world! from lib file\");\r\n//         $('.resetbutton').click(function () {\r\n//             console.log($(this).attr('id'));\r\n//             confirm(\"are you sure?\");\r\n//         });\r\n//     });\r\n//\r\n// });\r\n\r\ndefine(['jquery', 'core/ajax', 'core/modal_factory', 'core/modal_events', 'core/notification'],\r\n    function($, Ajax, ModalFactory, ModalEvents, Notification) {\r\n        $('.resetbutton').on('click', function(e) {\r\n            // var user_elementid = $(this).attr('name');\r\n            var myArray = [];\r\n            var elementid = $(this).attr('id');\r\n            // var userid = [];\r\n\r\n            // console.log(user_elementid);\r\n            // console.log(elementid);\r\n\r\n            $('.myCheckbox').each(function(k,V){\r\n                if(V.checked)\r\n                {\r\n                    // console.log(V.value);\r\n\r\n                    // var userid = new array(V.value);\r\n                     myArray.push(V.value);\r\n                     // console.log(myArray);\r\n                }\r\n            })\r\n\r\n            var array = elementid.split(\"_\");\r\n            // var userid = array[array.length - 2];\r\n            var courseid = array[array.length - 1];\r\n\r\n\r\n            var clickedLink = $(e.currentTarget);\r\n            ModalFactory.create({\r\n                type: ModalFactory.types.SAVE_CANCEL,\r\n                title: 'Reset grade',\r\n                body: 'Do you really want to reset?',\r\n            }).then(function (modal) {\r\n                modal.setSaveButtonText('Reset');\r\n                var root = modal.getRoot();\r\n                root.on(ModalEvents.save, function () {\r\n                    //var elementid = clickedLink.data('id');\r\n                    var wsfunction = 'tool_resetcoursecompletion_reset_grades';\r\n                    var params = {\r\n                        // 'userid': userid,\r\n                        'useridArray': myArray,\r\n                        'courseid': courseid,\r\n                    };\r\n                    var request = {\r\n                        methodname: wsfunction,\r\n                        args: params\r\n                    };\r\n                    console.log(request);\r\n                    Ajax.call([request])[0].done(function(data) {\r\n\r\n                        if (data.warnings.length < 1) {\r\n\r\n                            console.log(\"Response\");\r\n                            console.log(data);\r\n                            // Notification.addNotification({\r\n                            //     message: 'Done!',\r\n                            //     type: 'success'\r\n                            // });\r\n                            window.location.href = `http://localhost/moodle/admin/tool/resetcoursecompletion/index.php?id=${courseid}&submit=Show+Participants`;\r\n                            // location.reload(true);\r\n                        } else {\r\n                            Notification.addNotification({\r\n                                message: 'Something went wrong!',\r\n                                type: 'error'\r\n                            });\r\n                        }\r\n                    }).fail(Notification.exception);\r\n                });\r\n                modal.show();\r\n        });\r\n    });\r\n\r\n});"],"file":"resetbutton.min.js"}