{"version":3,"sources":["../src/resetbutton.js"],"names":["define","$","Ajax","str","ModalFactory","ModalEvents","Notification","on","e","myArray","elementid","attr","console","log","each","k","V","checked","push","value","array","split","courseid","length","clickedLink","currentTarget","get_string","then","langString","addNotification","message","type","catch","exception","create","types","SAVE_CANCEL","title","body","modal","setSaveButtonText","root","getRoot","save","params","join","request","methodname","args","call","done","data","warnings","window","location","href","fail","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n *  The Reset Course Completion grade report\r\n *\r\n * @module     tool_gradebookreset\r\n * @copyright  2021 Brain station 23 ltd <>  {@link https://brainstation-23.com/}\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\ndefine([\r\n    'jquery',\r\n    'core/ajax',\r\n    'core/str',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'core/notification'\r\n], function ($,\r\n             Ajax,\r\n             str,\r\n             ModalFactory,\r\n             ModalEvents,\r\n             Notification) {\r\n\r\n    $('.resetbutton').on('click', function (e) {\r\n        var myArray = [];\r\n        var elementid = $(this).attr('id');\r\n\r\n        console.log(elementid);\r\n\r\n        $('.myCheckbox').each(function (k, V) {\r\n            if (V.checked) {\r\n                myArray.push(V.value);\r\n                console.log(myArray);\r\n            }\r\n        })\r\n\r\n        var array = elementid.split(\"_\");\r\n        var courseid = array[array.length - 1];\r\n\r\n\r\n        var clickedLink = $(e.currentTarget);\r\n\r\n        console.log(myArray);\r\n        if(myArray.length<=0)\r\n        {\r\n            str.get_string('selectalert', 'tool_gradebookreset').then(function(langString) {\r\n                Notification.addNotification({\r\n                    message: langString,\r\n                    type: 'error'\r\n                });\r\n\r\n            }).catch(Notification.exception);\r\n        }\r\n\r\n        else {\r\n                ModalFactory.create({\r\n                    type: ModalFactory.types.SAVE_CANCEL,\r\n                    title: str.get_string('resettitle','tool_gradebookreset'),\r\n                    body: str.get_string('resetpermission','tool_gradebookreset')\r\n                }).then(function (modal) {\r\n                    modal.setSaveButtonText(str.get_string('reset','tool_gradebookreset'));\r\n                    var root = modal.getRoot();\r\n                    root.on(ModalEvents.save, function () {\r\n                        var wsfunction = 'tool_gradebookreset_reset_grades';\r\n                        var params = {\r\n                            'useridArray': myArray.join(','),\r\n                            'courseid': courseid,\r\n                        };\r\n                        var request = {\r\n                            methodname: wsfunction,\r\n                            args: params\r\n                        };\r\n                        console.log(request);\r\n                        Ajax.call([request])[0].done(function (data) {\r\n\r\n                            if (data.warnings.length < 1) {\r\n\r\n                                console.log(\"Response\");\r\n                                console.log(data);\r\n                                // window.location.href = `http://localhost/moodle/admin/tool/gradebookreset/index.php?id=${courseid}&submit=Show+Participants`;\r\n                                window.location.href = $(location).attr('href');\r\n\r\n\r\n                            } else {\r\n                                Notification.addNotification({\r\n                                    message: 'Something went wrong!',\r\n                                    type: 'error'\r\n                                });\r\n                            }\r\n                        }).fail(Notification.exception);\r\n                    });\r\n                    modal.show();\r\n                });\r\n        }\r\n\r\n    });\r\n\r\n});"],"file":"resetbutton.min.js"}